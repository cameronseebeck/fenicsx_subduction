
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Poisson Example 2D &#8212; FEniCSx Subduction</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=87e54e7c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=3ee479438cf8b5e0d341"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/Poisson2D';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Subduction Zone Benchmark" href="SubductionBenchmark.html" />
    <link rel="prev" title="Poisson Example 1D" href="Poisson1D.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
    <meta name="docbuild:last-update" content="Jun 02, 2024"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
  
    <p class="title logo__title">FEniCSx Subduction</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="index.html">
                    FEniCSx Subduction
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../readme.html">Overview</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Background</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Poisson1D.html">Poisson Example 1D</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Poisson Example 2D</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Subduction</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="SubductionBenchmark.html">Subduction Zone Benchmark</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/cianwilson/fenicsx_subduction/main?urlpath=lab/tree/./notebooks/Poisson2D.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/cianwilson/fenicsx_subduction" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/cianwilson/fenicsx_subduction/edit/main/./notebooks/Poisson2D.ipynb" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/cianwilson/fenicsx_subduction/issues/new?title=Issue%20on%20page%20%2Fnotebooks/Poisson2D.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/notebooks/Poisson2D.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Poisson Example 2D</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#description">Description</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#boundary-conditions">Boundary conditions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#weak-form">Weak form</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discretization">Discretization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-specific-example">A specific example</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementation">Implementation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#preamble">Preamble</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solution">Solution</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#themes-and-variations">Themes and variations</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="poisson-example-2d">
<h1>Poisson Example 2D<a class="headerlink" href="#poisson-example-2d" title="Link to this heading">#</a></h1>
<section id="description">
<h2>Description<a class="headerlink" href="#description" title="Link to this heading">#</a></h2>
<p>We can generalize (and formalize) the description of the Poisson equation
using the steady-state heat diffusion equation in multiple dimensions</p>
<div class="amsmath math notranslate nohighlight" id="equation-b3df825b-6691-4802-a169-3118757f7b1d">
<span class="eqno">(13)<a class="headerlink" href="#equation-b3df825b-6691-4802-a169-3118757f7b1d" title="Permalink to this equation">#</a></span>\[\begin{align}
-\nabla \cdot\left( k \nabla T \right) &amp;= H &amp;&amp; \text{in }\Omega
\end{align}\]</div>
<p><span class="math notranslate nohighlight">\(T\)</span> is the temperature solution we are seeking, <span class="math notranslate nohighlight">\(k\)</span> is the thermal conductivity and
<span class="math notranslate nohighlight">\(H\)</span> is a heat source, and <span class="math notranslate nohighlight">\(\Omega\)</span> is the domain with boundary <span class="math notranslate nohighlight">\(\partial\Omega\)</span>.  If <span class="math notranslate nohighlight">\(k\)</span> is constant in space we can simplify to</p>
<div class="amsmath math notranslate nohighlight" id="equation-afd1b7a3-16e9-43d9-aed2-8720ff130013">
<span class="eqno">(14)<a class="headerlink" href="#equation-afd1b7a3-16e9-43d9-aed2-8720ff130013" title="Permalink to this equation">#</a></span>\[\begin{align}
-\nabla^2 T &amp;= h &amp;&amp; \text{in }\Omega
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(h = \frac{H}{k}\)</span>.</p>
<section id="boundary-conditions">
<h3>Boundary conditions<a class="headerlink" href="#boundary-conditions" title="Link to this heading">#</a></h3>
<p>We supplement the Poisson equation with some combination of the boundary conditions</p>
<div class="amsmath math notranslate nohighlight" id="equation-5bdcf962-8dc5-47ce-8a16-c36c2f04e6d0">
<span class="eqno">(15)<a class="headerlink" href="#equation-5bdcf962-8dc5-47ce-8a16-c36c2f04e6d0" title="Permalink to this equation">#</a></span>\[\begin{align}
T &amp;= g_D &amp;&amp; \text{on } \partial\Omega_D \subset \partial\Omega \\
\nabla T\cdot\hat{\vec{n}} &amp;= g_N &amp;&amp; \text{on } \partial\Omega_N \subset \partial\Omega \\
aT + \nabla T\cdot\hat{\vec{n}} &amp;= g_R &amp;&amp; \text{on } \partial\Omega_R \subset \partial\Omega 
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(\partial\Omega_D\)</span>, <span class="math notranslate nohighlight">\(\partial\Omega_N\)</span> and <span class="math notranslate nohighlight">\(\partial\Omega_R\)</span> are
segments of the domain boundary that do not overlap (<span class="math notranslate nohighlight">\(\partial\Omega_D \bigcap \partial\Omega_N =\emptyset\)</span>, <span class="math notranslate nohighlight">\(\partial\Omega_D \bigcap \partial\Omega_R =\emptyset\)</span>, <span class="math notranslate nohighlight">\(\partial\Omega_N \bigcap \partial\Omega_R =\emptyset\)</span>) and that together span the entire boundary (<span class="math notranslate nohighlight">\(\partial\Omega_D \bigcup \partial\Omega_N \bigcup \partial\Omega_R = \partial\Omega\)</span>).  The unit outward-pointing normal to the boundary <span class="math notranslate nohighlight">\(\partial\Omega\)</span> is denoted by <span class="math notranslate nohighlight">\(\hat{\vec{n}}\)</span> and <span class="math notranslate nohighlight">\(g_D = g_D(\vec{x}, t)\)</span>, <span class="math notranslate nohighlight">\(g_N = g_N(\vec{x}, t)\)</span> and <span class="math notranslate nohighlight">\(g_R = g_R(\vec{x}, t)\)</span> are known functions of space and time.</p>
<p>The first boundary condition is known as a Dirichlet boundary condition and specifies the value of the solution on <span class="math notranslate nohighlight">\(\partial\Omega_D\)</span>. The second is a Neumann boundary condition and specifies the value of the flux through <span class="math notranslate nohighlight">\(\partial\Omega_N\)</span>. Finally, the third is a Robin boundary condition, which describes a linear combination of the flux and the solution on <span class="math notranslate nohighlight">\(\partial\Omega_R\)</span>.</p>
</section>
<section id="weak-form">
<h3>Weak form<a class="headerlink" href="#weak-form" title="Link to this heading">#</a></h3>
<p>The first step in the finite element discretization is to transform the equation into its <strong>weak form</strong>.  This requires multiplying the equation by a test function,  <span class="math notranslate nohighlight">\(T_t\)</span>,  and integrating over the domain <span class="math notranslate nohighlight">\(\Omega\)</span></p>
<div class="amsmath math notranslate nohighlight" id="equation-4b1c8173-0317-4f1c-b659-e05df18a5631">
<span class="eqno">(16)<a class="headerlink" href="#equation-4b1c8173-0317-4f1c-b659-e05df18a5631" title="Permalink to this equation">#</a></span>\[\begin{equation}
-\int_\Omega T_t \nabla^2 T ~dx = \int_\Omega T_t h ~dx
\end{equation}\]</div>
<p>After integrating the left-hand side by parts</p>
<div class="amsmath math notranslate nohighlight" id="equation-ab8e1f91-2277-4493-84f1-28eb09f54548">
<span class="eqno">(17)<a class="headerlink" href="#equation-ab8e1f91-2277-4493-84f1-28eb09f54548" title="Permalink to this equation">#</a></span>\[\begin{equation}
\int_\Omega \nabla T_t \cdot \nabla T ~dx - \int_{\partial\Omega} T_t \nabla T\cdot\hat{\vec{n}}~ds = \int_\Omega T_t h ~dx
\end{equation}\]</div>
<p>we can see that we have reduced the continuity requirements on <span class="math notranslate nohighlight">\(T\)</span> by only requiring its first derivative to be bounded across <span class="math notranslate nohighlight">\(\Omega\)</span>. Integrating by parts also allows Neumann and Robin boundary conditions to be imposed “naturally” through the second integral on the left-hand side since this directly incorporates the flux components across the boundary.  In this formulation, Dirichlet conditions cannot be imposed weakly and are referred to as essential boundary conditions,  that are required of the solution but do not arise naturally in the weak form.  The weak form therefore becomes: find <span class="math notranslate nohighlight">\(T\)</span> such that <span class="math notranslate nohighlight">\(T\)</span>=<span class="math notranslate nohighlight">\(g_D\)</span> on <span class="math notranslate nohighlight">\(\partial\Omega_D\)</span> and</p>
<div class="amsmath math notranslate nohighlight" id="equation-e715a2f9-98c3-4dee-81f2-9c911b475f05">
<span class="eqno">(18)<a class="headerlink" href="#equation-e715a2f9-98c3-4dee-81f2-9c911b475f05" title="Permalink to this equation">#</a></span>\[\begin{equation}
\int_\Omega \nabla T_t \cdot \nabla T ~dx - \int_{\partial\Omega_N} T_t g_N ~ds - \int_{\partial\Omega_R} T_t \left(g_R - aT\right)~ds = \int_\Omega T_t h ~dx
\end{equation}\]</div>
<p>for all <span class="math notranslate nohighlight">\(T_t\)</span> such that <span class="math notranslate nohighlight">\(T_t = 0\)</span> on <span class="math notranslate nohighlight">\(\partial\Omega_D\)</span>.</p>
</section>
<section id="discretization">
<h3>Discretization<a class="headerlink" href="#discretization" title="Link to this heading">#</a></h3>
<p>The weak and strong forms of the problem are equivalent so long as the solution is sufficiently smooth.  We make our first approximation by, instead of seeking <span class="math notranslate nohighlight">\(T\)</span> such that <span class="math notranslate nohighlight">\(T = g_D\)</span> on <span class="math notranslate nohighlight">\(\partial\Omega_D\)</span>, seeking the discrete trial function <span class="math notranslate nohighlight">\(\tilde{T}\)</span> such that <span class="math notranslate nohighlight">\(\tilde{T} = g_D\)</span> on <span class="math notranslate nohighlight">\(\partial\Omega_D\)</span> where</p>
<div class="amsmath math notranslate nohighlight" id="equation-8874ad28-8823-420e-9261-290b5e50411f">
<span class="eqno">(19)<a class="headerlink" href="#equation-8874ad28-8823-420e-9261-290b5e50411f" title="Permalink to this equation">#</a></span>\[\begin{equation}
T \approx \tilde{T} = \sum_j \phi_j T_j
\end{equation}\]</div>
<p>for all test functions <span class="math notranslate nohighlight">\(\tilde{T}_t\)</span> where</p>
<div class="amsmath math notranslate nohighlight" id="equation-49714554-b533-4476-9c5d-386d14318ead">
<span class="eqno">(20)<a class="headerlink" href="#equation-49714554-b533-4476-9c5d-386d14318ead" title="Permalink to this equation">#</a></span>\[\begin{equation}
T_t \approx \tilde{T}_t = \sum_i \phi_i T_{ti}
\end{equation}\]</div>
<p>noting again that <span class="math notranslate nohighlight">\(\tilde{T}_t = 0\)</span> on <span class="math notranslate nohighlight">\(\partial\Omega_D\)</span>.<br />
<span class="math notranslate nohighlight">\(\phi_j\)</span> are the finite element shape functions. Assuming these are continuous across elements of the mesh, <span class="math notranslate nohighlight">\(\tilde{T}\)</span> and <span class="math notranslate nohighlight">\(\tilde{T}_t\)</span> can be substituted into the weak form to yield</p>
<div class="amsmath math notranslate nohighlight" id="equation-461e7973-324b-4fa4-8359-7aafc15f56e1">
<span class="eqno">(21)<a class="headerlink" href="#equation-461e7973-324b-4fa4-8359-7aafc15f56e1" title="Permalink to this equation">#</a></span>\[\begin{multline}
\sum_i\sum_j T_{ti}T_j\sum_k  \int_{e_k} \nabla \phi_i \cdot \nabla \phi_j ~dx 
 + \sum_i\sum_j T_{ti}T_j \sum_k \int_{\partial e_k \cap {\partial\Omega_R}} \phi_i a\phi_j ~ds
\\- \sum_i T_{ti} \sum_k \int_{\partial e_k \cap {\partial\Omega_N}} \phi_i g_N ~ds 
- \sum_i T_{ti} \sum_k \int_{\partial e_k \cap {\partial\Omega_R}} \phi_i g_R 
\\= \sum_i T_{ti} \sum_k \int_{e_k} \phi_i h ~dx
\end{multline}\]</div>
<p>where we are integrating over the whole domain by summing the integrals over all the elements  <span class="math notranslate nohighlight">\(e_k\)</span> (<span class="math notranslate nohighlight">\(\int_\Omega dx\)</span>=<span class="math notranslate nohighlight">\(\sum_k\int_{e_k} dx\)</span>).  Note that in practice, because the shape functions are zero over most of the domain, only element integrals with non-zero values need be included in the summation.  The element boundaries, <span class="math notranslate nohighlight">\(\partial e_k\)</span>, are only of interest (due to the assumed continuity of the shape functions between the elements) if they either intersect with <span class="math notranslate nohighlight">\(\partial\Omega_N\)</span>, <span class="math notranslate nohighlight">\(\partial e_k \cap {\partial\Omega_N}\)</span>, or <span class="math notranslate nohighlight">\(\partial\Omega_R\)</span>, <span class="math notranslate nohighlight">\(\partial e_k \cap {\partial\Omega_R}\)</span>.  Since the solution of the now discretized weak form should be valid for all <span class="math notranslate nohighlight">\(\tilde{T}_t\)</span> we can drop <span class="math notranslate nohighlight">\(T_{ti}\)</span></p>
<div class="amsmath math notranslate nohighlight" id="equation-bea4bb48-2405-4d49-8c33-9d17da042b1c">
<span class="eqno">(22)<a class="headerlink" href="#equation-bea4bb48-2405-4d49-8c33-9d17da042b1c" title="Permalink to this equation">#</a></span>\[\begin{multline}
\sum_jT_j\sum_k  \int_{e_k} \nabla \phi_i \cdot \nabla \phi_j ~dx 
 + \sum_jT_j\sum_k \int_{\partial e_k \cap {\partial\Omega_R}} \phi_i a \phi_j ~ds
\\- \sum_k \int_{\partial e_k \cap {\partial\Omega_N}} \phi_i g_N ~ds 
- \sum_k \int_{\partial e_k \cap {\partial\Omega_R}} \phi_i g_R~ds 
= \sum_k \int_{e_k} \phi_i h ~dx
\end{multline}\]</div>
<p>This represents a matrix-vector system of the form</p>
<div class="amsmath math notranslate nohighlight" id="equation-10c31a59-bc5e-4f03-ad6c-6996545437c7">
<span class="eqno">(23)<a class="headerlink" href="#equation-10c31a59-bc5e-4f03-ad6c-6996545437c7" title="Permalink to this equation">#</a></span>\[\begin{equation}
{\bf S} {\bf u} = {\bf f}
\end{equation}\]</div>
<p>with</p>
<div class="amsmath math notranslate nohighlight" id="equation-9adfe549-ceb9-4a71-be6d-29bd41d380dc">
<span class="eqno">(24)<a class="headerlink" href="#equation-9adfe549-ceb9-4a71-be6d-29bd41d380dc" title="Permalink to this equation">#</a></span>\[\begin{align}
{\bf S} &amp;= S_{ij} = \sum_k\int_{e_k} \nabla \phi_i \cdot \nabla \phi_j ~dx + \sum_k \int_{\partial e_k \cap {\partial\Omega_R}} \phi_i a\phi_j ~ds  \\
{\bf f} &amp;= f_i = \sum_k \int_{e_k} \phi_i h ~dx + \sum_k \int_{\partial e_k \cap {\partial\Omega_N}} \phi_i g_N ~ds 
+ \sum_k \int_{\partial e_k \cap {\partial\Omega_R}} \phi_i g_R~ds \\
{\bf u} &amp;= {\bf T} = T_j 
\end{align}\]</div>
<p>The compact support of the shape functions <span class="math notranslate nohighlight">\(\phi_{(i,j)}\)</span>, which limits their nonzero values to the elements immediately neighboring DOF <span class="math notranslate nohighlight">\(i\)</span> or <span class="math notranslate nohighlight">\(j\)</span>, means that the integrals in can be evaluated efficiently by only considering shape functions associated with an element <span class="math notranslate nohighlight">\(e_k\)</span>.  It also means that the resulting matrix <span class="math notranslate nohighlight">\({\bf S}\)</span> is sparse, with most entries being zero.</p>
</section>
<section id="a-specific-example">
<h3>A specific example<a class="headerlink" href="#a-specific-example" title="Link to this heading">#</a></h3>
<p>In this case we use a manufactured solution (that is, one that is not necessarily an example of a solution to a PDE representing a naturally occurring physical problem) where we take a known analytical solution <span class="math notranslate nohighlight">\(T(x,y)\)</span> and substitute this into the original equation to find <span class="math notranslate nohighlight">\(h\)</span>, then use this as the right-hand side in our numerical test. We choose <span class="math notranslate nohighlight">\(T(x,y)\)</span>=<span class="math notranslate nohighlight">\(\exp\left(x+\tfrac{y}{2}\right)\)</span>, which is the solution to</p>
<div class="amsmath math notranslate nohighlight" id="equation-cf15e370-ff63-468c-bd1c-7cfbab013dbb">
<span class="eqno">(25)<a class="headerlink" href="#equation-cf15e370-ff63-468c-bd1c-7cfbab013dbb" title="Permalink to this equation">#</a></span>\[\begin{equation}
- \nabla^2 T = -\tfrac{5}{4} \exp \left( x+\tfrac{y}{2} \right)
\end{equation}\]</div>
<p>Solving the Poisson equation numerically in a unit square, <span class="math notranslate nohighlight">\(\Omega=[0,1]\times[0,1]\)</span>, for the approximate solution <span class="math notranslate nohighlight">\(\tilde{T} \approx T\)</span>, we impose the boundary conditions</p>
<div class="amsmath math notranslate nohighlight" id="equation-5af9d9b2-e263-42c2-9b3a-39e60215de4f">
<span class="eqno">(26)<a class="headerlink" href="#equation-5af9d9b2-e263-42c2-9b3a-39e60215de4f" title="Permalink to this equation">#</a></span>\[\begin{align}
  \tilde{T} &amp;= \exp\left(x+\tfrac{y}{2}\right) &amp;&amp; \text{on } \partial\Omega \text{ where } x=0 \text{ or } y=0 \\
  \nabla \tilde{T}\cdot \hat{\vec{n}} &amp;= \exp\left(x + \tfrac{y}{2}\right) &amp;&amp; \text{on } \partial\Omega \text{ where } x=1  \\
  \nabla \tilde{T}\cdot \hat{\vec{n}} &amp;= \tfrac{1}{2}\exp\left(x + \tfrac{y}{2}\right) &amp;&amp; \text{on } \partial\Omega \text{ where } y=1
 \end{align}\]</div>
<p>representing an essential Dirichlet condition on the value of <span class="math notranslate nohighlight">\(\tilde{T}\)</span> and natural Neumann conditions on <span class="math notranslate nohighlight">\(\nabla\tilde{T}\)</span>.</p>
</section>
</section>
<section id="implementation">
<h2>Implementation<a class="headerlink" href="#implementation" title="Link to this heading">#</a></h2>
<p>This example was presented by <a class="reference external" href="http://dx.doi.org/10.1186/s40645-023-00588-6">Wilson &amp; van Keken, 2023</a> using FEniCS v2019.1.0 and <a class="reference internal" href="#terraferma.github.io"><span class="xref myst">TerraFERMA</span></a>, a GUI-based model building framework that also uses FEniCS v2019.1.0.  Here we reproduce these results using the latest version of FEniCS, FEniCSx.</p>
<section id="preamble">
<h3>Preamble<a class="headerlink" href="#preamble" title="Link to this heading">#</a></h3>
<p>We start by loading all the modules we will require.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mpi4py</span> <span class="kn">import</span> <span class="n">MPI</span>
<span class="kn">import</span> <span class="nn">dolfinx</span> <span class="k">as</span> <span class="nn">df</span>
<span class="kn">import</span> <span class="nn">dolfinx.fem.petsc</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">ufl</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">pl</span>
<span class="kn">import</span> <span class="nn">pathlib</span>
<span class="kn">import</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">os</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">pardir</span><span class="p">,</span> <span class="s1">&#39;python&#39;</span><span class="p">))</span>
<span class="kn">import</span> <span class="nn">utils</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="solution">
<h3>Solution<a class="headerlink" href="#solution" title="Link to this heading">#</a></h3>
<p>We then declare a python function <code class="docutils literal notranslate"><span class="pre">solve_poisson_2d</span></code> that contains a complete description of the discrete Poisson equation problem.</p>
<p>This function follows much the same flow as described above:</p>
<ol class="arabic simple">
<li><p>we describe the unit square domain <span class="math notranslate nohighlight">\(\Omega = [0,1]\times[0,1]\)</span> and discretize it into <span class="math notranslate nohighlight">\(2\times\)</span><code class="docutils literal notranslate"><span class="pre">ne</span></code><span class="math notranslate nohighlight">\(\times\)</span><code class="docutils literal notranslate"><span class="pre">ne</span></code> triangular elements or cells to make a <code class="docutils literal notranslate"><span class="pre">mesh</span></code></p></li>
<li><p>we declare the <strong>function space</strong>, <code class="docutils literal notranslate"><span class="pre">V</span></code>, to use Lagrange polynomials of degree <code class="docutils literal notranslate"><span class="pre">p</span></code></p></li>
<li><p>using this function space we declare trial, <code class="docutils literal notranslate"><span class="pre">T_a</span></code>, and test, <code class="docutils literal notranslate"><span class="pre">T_t</span></code>, functions</p></li>
<li><p>we define the Dirichlet boundary condition, <code class="docutils literal notranslate"><span class="pre">bc</span></code> at <span class="math notranslate nohighlight">\(x=0\)</span> and <span class="math notranslate nohighlight">\(y=0\)</span>, setting the desired value there to the known exact solution</p></li>
<li><p>we define a finite element <code class="docutils literal notranslate"><span class="pre">Function</span></code>, <code class="docutils literal notranslate"><span class="pre">gN</span></code>, containing the values of <span class="math notranslate nohighlight">\(\nabla \tilde{T}\)</span> on the Neumann boundaries <span class="math notranslate nohighlight">\(x=1\)</span> and <span class="math notranslate nohighlight">\(y=1\)</span> (note that this will be used in the weak form rather than as a boundary condition object)</p></li>
<li><p>we define the right hand side forcing function <span class="math notranslate nohighlight">\(h\)</span>, <code class="docutils literal notranslate"><span class="pre">h</span></code></p></li>
<li><p>we describe the <strong>discrete weak forms</strong>, <code class="docutils literal notranslate"><span class="pre">S</span></code> and <code class="docutils literal notranslate"><span class="pre">f</span></code>, that will be used to assemble the matrix <span class="math notranslate nohighlight">\(\mathbf{S}\)</span> and vector <span class="math notranslate nohighlight">\(\mathbf{f}\)</span></p></li>
<li><p>we solve the matrix problem using a linear algebra back-end and return the solution</p></li>
</ol>
<p>For a more detailed description of solving the Poisson equation using FEniCSx, see <a class="reference external" href="https://jsdokken.com/dolfinx-tutorial/chapter1/fundamentals.html">the FEniCSx tutorial</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">solve_poisson_2d</span><span class="p">(</span><span class="n">ne</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A python function to solve a two-dimensional Poisson problem</span>
<span class="sd">    on a unit square domain.</span>
<span class="sd">    Parameters:</span>
<span class="sd">    * ne - number of elements in each dimension</span>
<span class="sd">    * p  - polynomial order of the solution function space</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Describe the domain (a unit square)</span>
    <span class="c1"># and also the tessellation of that domain into ne </span>
    <span class="c1"># equally spaced squares in each dimension which are</span>
    <span class="c1"># subdivided into two triangular elements each</span>
    <span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">create_unit_square</span><span class="p">(</span><span class="n">MPI</span><span class="o">.</span><span class="n">COMM_WORLD</span><span class="p">,</span> <span class="n">ne</span><span class="p">,</span> <span class="n">ne</span><span class="p">)</span>

    <span class="c1"># Define the solution function space using Lagrange polynomials</span>
    <span class="c1"># of order p</span>
    <span class="n">V</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">functionspace</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;Lagrange&quot;</span><span class="p">,</span> <span class="n">p</span><span class="p">))</span>

    <span class="c1"># Define the trial and test functions on the same function space (V)</span>
    <span class="n">T_a</span> <span class="o">=</span> <span class="n">ufl</span><span class="o">.</span><span class="n">TrialFunction</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
    <span class="n">T_t</span> <span class="o">=</span> <span class="n">ufl</span><span class="o">.</span><span class="n">TestFunction</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>

    <span class="c1"># Define the location of the boundary condition, x=0 and y=0</span>
    <span class="k">def</span> <span class="nf">boundary</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">0</span><span class="p">))</span>
    <span class="n">boundary_dofs</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">locate_dofs_geometrical</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">boundary</span><span class="p">)</span>
    <span class="c1"># Specify the value and define a Dirichlet boundary condition (bc)</span>
    <span class="n">gD</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">Function</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
    <span class="n">gD</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mf">2.</span><span class="p">))</span>
    <span class="n">bc</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">dirichletbc</span><span class="p">(</span><span class="n">gD</span><span class="p">,</span> <span class="n">boundary_dofs</span><span class="p">)</span>

    <span class="c1"># Get the coordinates</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">ufl</span><span class="o">.</span><span class="n">SpatialCoordinate</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span>
    <span class="c1"># Define the Neumann boundary condition function</span>
    <span class="n">gN</span> <span class="o">=</span> <span class="n">ufl</span><span class="o">.</span><span class="n">as_vector</span><span class="p">((</span><span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mf">2.</span><span class="p">),</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mf">2.</span><span class="p">)))</span>
    <span class="c1"># Define the right hand side function, h</span>
    <span class="n">h</span> <span class="o">=</span> <span class="o">-</span><span class="mf">5.</span><span class="o">/</span><span class="mf">4.</span><span class="o">*</span><span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span>

    <span class="c1"># Get the unit vector normal to the facets</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">ufl</span><span class="o">.</span><span class="n">FacetNormal</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span>
    <span class="c1"># Define the integral to be assembled into the stiffness matrix</span>
    <span class="n">S</span> <span class="o">=</span> <span class="n">ufl</span><span class="o">.</span><span class="n">inner</span><span class="p">(</span><span class="n">ufl</span><span class="o">.</span><span class="n">grad</span><span class="p">(</span><span class="n">T_t</span><span class="p">),</span> <span class="n">ufl</span><span class="o">.</span><span class="n">grad</span><span class="p">(</span><span class="n">T_a</span><span class="p">))</span><span class="o">*</span><span class="n">ufl</span><span class="o">.</span><span class="n">dx</span>
    <span class="c1"># Define the integral to be assembled into the forcing vector,</span>
    <span class="c1"># incorporating the Neumann boundary condition weakly</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">T_t</span><span class="o">*</span><span class="n">h</span><span class="o">*</span><span class="n">ufl</span><span class="o">.</span><span class="n">dx</span> <span class="o">+</span> <span class="n">T_t</span><span class="o">*</span><span class="n">ufl</span><span class="o">.</span><span class="n">inner</span><span class="p">(</span><span class="n">gN</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="n">ufl</span><span class="o">.</span><span class="n">ds</span>

    <span class="c1"># Compute the solution (given the boundary condition, bc)</span>
    <span class="n">problem</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">petsc</span><span class="o">.</span><span class="n">LinearProblem</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">bcs</span><span class="o">=</span><span class="p">[</span><span class="n">bc</span><span class="p">],</span> \
                                         <span class="n">petsc_options</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;ksp_type&quot;</span><span class="p">:</span> <span class="s2">&quot;preonly&quot;</span><span class="p">,</span> \
                                                        <span class="s2">&quot;pc_type&quot;</span><span class="p">:</span> <span class="s2">&quot;lu&quot;</span><span class="p">})</span>
    <span class="n">T_i</span> <span class="o">=</span> <span class="n">problem</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">T_i</span>
</pre></div>
</div>
</div>
</div>
<p>We can now numerically solve the equations using, e.g. 4 elements and piecewise linear polynomials.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T_P1</span> <span class="o">=</span> <span class="n">solve_poisson_2d</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>And use a utility function to plot it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">utils</span><span class="o">.</span><span class="n">plot_scalar</span><span class="p">(</span><span class="n">T_P1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/49e873535b2e0fab522f616b7e1a3bf1d926082252b0a684502a9ab0bf038c29.png" src="../_images/49e873535b2e0fab522f616b7e1a3bf1d926082252b0a684502a9ab0bf038c29.png" />
</div>
</div>
<p>Similarly, we can solve the equation using quadratic elements (<code class="docutils literal notranslate"><span class="pre">p=2</span></code>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T_P2</span> <span class="o">=</span> <span class="n">solve_poisson_2d</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">utils</span><span class="o">.</span><span class="n">plot_scalar</span><span class="p">(</span><span class="n">T_P2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/0dfa46cc5444169ea16c5e5abc434d66910130eb8f98f6bb9007de5ba77dd04b.png" src="../_images/0dfa46cc5444169ea16c5e5abc434d66910130eb8f98f6bb9007de5ba77dd04b.png" />
</div>
</div>
</section>
</section>
<section id="themes-and-variations">
<h2>Themes and variations<a class="headerlink" href="#themes-and-variations" title="Link to this heading">#</a></h2>
<p>Given that we know the exact solution to this problem is <span class="math notranslate nohighlight">\(T(x,y)\)</span>=<span class="math notranslate nohighlight">\(\exp\left(x+\tfrac{y}{2}\right)\)</span> write a python function to evaluate the error in our numerical solution.</p>
<p>Then loop over a variety of <code class="docutils literal notranslate"><span class="pre">ne</span></code>s and <code class="docutils literal notranslate"><span class="pre">p</span></code>s and check that the numerical solution converges with an increasing number of degrees of freedom.</p>
<p>Note that, aside from the analytic solution being different, this is very similar to the 1D case in <code class="docutils literal notranslate"><span class="pre">Poisson1D.ipynb</span></code>.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Poisson1D.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Poisson Example 1D</p>
      </div>
    </a>
    <a class="right-next"
       href="SubductionBenchmark.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Subduction Zone Benchmark</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#description">Description</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#boundary-conditions">Boundary conditions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#weak-form">Weak form</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discretization">Discretization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-specific-example">A specific example</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementation">Implementation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#preamble">Preamble</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solution">Solution</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#themes-and-variations">Themes and variations</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Cian Wilson
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    <p class="last-updated">
  Last updated on Jun 02, 2024.
  <br/>
</p>
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>